= WARNING =

MY BEST ADVICE - IF ANY OF THE FOLLOWING SEEMS CONFUSING OR YOU ARE NOT SURE  - DON'T DO IT !!!! - YOU MAY SERIOUSLY B0rK YOUR SYSTEM. 
THIS HOWTO HAS NOT BEEN THOROUGHLY TESTED AND HAS AT LEAST TWO SCARY RM'S WITH WILDCARDS :)

YOU HAVE BEEN WARNED !!

= Introduction =

The web viewer has been developed & runs on a stock kubuntu Gutsy 7.10

motion 3.2.3
PHP    5.2.3
Apache 2.2.4
Python 2.5.1

= Server setup notes =

install a stock Gutsy server

apt-get install motion, apache2, python, libapache2-mod-php5, ntp, screen

Setup server for auto update, add the following to /etc/cron.daily
call it auto-update.sh & make it executable
----
_#!/bin/bash_

_aptitude -y update > /dev/null && aptitude -y safe-upgrade > /dev/null && aptitude -y dist-upgrade > /dev/null && aptitude -y autoclean > /dev/null_
----

= Kmotion daemon notes =

This will be a KDE app, its config is in the standard KDE dirs, although KDE is not installed you need to pretend it is :)

mkdir -p ~/.kde/share/apps/kmotion

cd ~/.kde/share/apps/kmotion

unzip daemons.tar.gz

The daemons start motion & do all sorts of housekeeping, to start the deamons at bootup edit /etc/rc.local and add the line

----
_su dave -c /home/dave/.kde/share/apps/kmotion/kmotion_start.py &_
----

cd /var/lib

chgrp www-data motion

= Kmotion Apache notes =

cd /var/www

<CAREFULL!!>rm -rf *

unzip apache1.tar.gz

cd /etc/apache2

<CAREFULL!!>rm -rf *

unzip apache2.tar.gz

/etc/init.d/apache restart

= Kmotion config notes =

Config comes in two parts, the easy bit first - the Apache loggin :)

cd /var/www

htpasswd -c .htpasswd <user name>

Then enter your password twice. If you do not want a loggin dialogue remove .htaccess & .htpasswd & restart Apache

Now difficult bit.

cd ~/.kde/share/apps/kmotion

vi kmotion.rc

This file configures everything, go have a look ... hopefully its pretty self explanitory

file_system & cull_trigpc trigger auto deleteion of the oldest files when the disk becomes more that cull_trigpc full

feed_common is motion.conf
feed1 - 16 are motion.conf threads

You can put anything in these sections that you can in motions config file with the addition of 'name:' the name of the web view for that feed & 'live:' if the feed is live. motion.conf & its threads are auto generated from this file.

*NOTE* feeds must be 'live: yes' from feed1 upwards until a 'live: no' no gaps are allowed

= Finally =

Reboot the system , pray, and tell me where it broke ;)